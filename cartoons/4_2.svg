<svg width="750" height="500" xmlns="http://www.w3.org/2000/svg">
    <!-- Background -->
    <rect width="750" height="500" fill="#f9f9f9" rx="10" ry="10"/>
<!-- Title -->
<text x="375" y="40" font-family="Arial" font-size="24" text-anchor="middle" font-weight="bold" fill="#333">Linear Mixed Model Visualization</text>

<!-- Equation -->
<text x="375" y="80" font-family="Arial" font-size="20" text-anchor="middle" fill="#555" font-style="italic">y = Xβ + Zu + ε</text>

<!-- Main visualization area -->
<rect x="50" y="100" width="650" height="300" fill="#fff" stroke="#ddd" stroke-width="2" rx="5" ry="5"/>

<!-- Data points (phenotype values y) -->
<g id="data-points">
    <!-- Related individuals are shown with similar colors -->
    <circle cx="150" cy="200" r="12" fill="#ff9999"/>
    <circle cx="180" cy="230" r="12" fill="#ff9999"/>
    <circle cx="130" cy="240" r="12" fill="#ff9999"/>
    
    <circle cx="250" cy="180" r="12" fill="#99ccff"/>
    <circle cx="280" cy="150" r="12" fill="#99ccff"/>
    <circle cx="260" cy="200" r="12" fill="#99ccff"/>
    
    <circle cx="350" cy="300" r="12" fill="#99ff99"/>
    <circle cx="380" cy="270" r="12" fill="#99ff99"/>
    <circle cx="400" cy="290" r="12" fill="#99ff99"/>
    
    <circle cx="500" cy="150" r="12" fill="#ffcc99"/>
    <circle cx="520" cy="180" r="12" fill="#ffcc99"/>
    <circle cx="490" cy="170" r="12" fill="#ffcc99"/>
    
    <circle cx="600" cy="250" r="12" fill="#cc99ff"/>
    <circle cx="620" cy="220" r="12" fill="#cc99ff"/>
    <circle cx="580" cy="230" r="12" fill="#cc99ff"/>
</g>

<!-- Fixed effects (Xβ) -->
<g id="fixed-effects">
    <line x1="50" y1="350" x2="700" y2="150" stroke="#e74c3c" stroke-width="4" stroke-dasharray="10,5"/>
    <text x="580" y="140" font-family="Arial" font-size="16" fill="#e74c3c" font-weight="bold">Xβ (Fixed effects)</text>
</g>

<!-- Random effects (Zu) - represented by family clusters -->
<g id="random-effects">
    <!-- Family circles representing the correlation structure -->
    <circle cx="160" cy="220" r="60" fill="rgba(255,153,153,0.2)" stroke="#ff6666" stroke-width="2" stroke-dasharray="5,3"/>
    <circle cx="260" cy="180" r="60" fill="rgba(153,204,255,0.2)" stroke="#6699cc" stroke-width="2" stroke-dasharray="5,3"/>
    <circle cx="380" cy="290" r="60" fill="rgba(153,255,153,0.2)" stroke="#66cc66" stroke-width="2" stroke-dasharray="5,3"/>
    <circle cx="500" cy="170" r="60" fill="rgba(255,204,153,0.2)" stroke="#ffaa66" stroke-width="2" stroke-dasharray="5,3"/>
    <circle cx="600" cy="230" r="60" fill="rgba(204,153,255,0.2)" stroke="#aa66ff" stroke-width="2" stroke-dasharray="5,3"/>
    
    <text x="160" y="220" font-family="Arial" font-size="12" text-anchor="middle" fill="#ff6666">Family 1</text>
    <text x="260" y="180" font-family="Arial" font-size="12" text-anchor="middle" fill="#6699cc">Family 2</text>
    <text x="380" y="290" font-family="Arial" font-size="12" text-anchor="middle" fill="#66cc66">Family 3</text>
    <text x="500" y="170" font-family="Arial" font-size="12" text-anchor="middle" fill="#ffaa66">Family 4</text>
    <text x="600" y="230" font-family="Arial" font-size="12" text-anchor="middle" fill="#aa66ff">Family 5</text>
    
    <text x="160" y="140" font-family="Arial" font-size="16" fill="#9966cc" font-weight="bold">Zu (Random effects)</text>
</g>

<!-- Residuals (ε) -->
<g id="residuals">
    <!-- Vertical lines showing deviation from fixed effects line -->
    <line x1="150" y1="200" x2="150" y2="271" stroke="#aaaaaa" stroke-width="2" stroke-dasharray="3,3"/>
    <line x1="180" y1="230" x2="180" y2="264" stroke="#aaaaaa" stroke-width="2" stroke-dasharray="3,3"/>
    <line x1="130" y1="240" x2="130" y2="279" stroke="#aaaaaa" stroke-width="2" stroke-dasharray="3,3"/>
    
    <line x1="250" y1="180" x2="250" y2="234" stroke="#aaaaaa" stroke-width="2" stroke-dasharray="3,3"/>
    <line x1="280" y1="150" x2="280" y2="220" stroke="#aaaaaa" stroke-width="2" stroke-dasharray="3,3"/>
    <line x1="260" y1="200" x2="260" y2="229" stroke="#aaaaaa" stroke-width="2" stroke-dasharray="3,3"/>
    
    <line x1="350" y1="300" x2="350" y2="204" stroke="#aaaaaa" stroke-width="2" stroke-dasharray="3,3"/>
    <line x1="380" y1="270" x2="380" y2="188" stroke="#aaaaaa" stroke-width="2" stroke-dasharray="3,3"/>
    <line x1="400" y1="290" x2="400" y2="179" stroke="#aaaaaa" stroke-width="2" stroke-dasharray="3,3"/>
    
    <line x1="500" y1="150" x2="500" y2="140" stroke="#aaaaaa" stroke-width="2" stroke-dasharray="3,3"/>
    <line x1="520" y1="180" x2="520" y2="131" stroke="#aaaaaa" stroke-width="2" stroke-dasharray="3,3"/>
    <line x1="490" y1="170" x2="490" y2="145" stroke="#aaaaaa" stroke-width="2" stroke-dasharray="3,3"/>
    
    <line x1="600" y1="250" x2="600" y2="100" stroke="#aaaaaa" stroke-width="2" stroke-dasharray="3,3"/>
    <line x1="620" y1="220" x2="620" y2="91" stroke="#aaaaaa" stroke-width="2" stroke-dasharray="3,3"/>
    <line x1="580" y1="230" x2="580" y2="109" stroke="#aaaaaa" stroke-width="2" stroke-dasharray="3,3"/>
    
    <text x="560" y="300" font-family="Arial" font-size="16" fill="#777777" font-weight="bold">ε (Residuals)</text>
</g>

<!-- Axes -->
<g id="axes">
    <line x1="50" y1="400" x2="700" y2="400" stroke="#555" stroke-width="2"/>
    <line x1="50" y1="400" x2="50" y2="100" stroke="#555" stroke-width="2"/>
    
    <text x="375" y="430" font-family="Arial" font-size="16" text-anchor="middle" fill="#555">Genotype (X)</text>
    <text x="30" y="250" font-family="Arial" font-size="16" text-anchor="middle" fill="#555" transform="rotate(-90,30,250)">Phenotype (y)</text>
</g>

<!-- Legend -->
<rect x="50" y="450" width="650" height="40" fill="rgba(255,255,255,0.7)" stroke="#ddd" rx="5" ry="5"/>
<text x="375" y="475" font-family="Arial" font-size="14" text-anchor="middle" fill="#333">
    LMM accounts for both fixed effects (genetic variants) and random effects (family relatedness)
</text>
    
</svg>