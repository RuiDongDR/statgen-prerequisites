<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600">
  <!-- Background -->
  <rect width="800" height="600" fill="#f8f9fa" rx="10" ry="10"/>
  
  <!-- Title -->
  <text x="400" y="40" font-family="Arial" font-size="24" text-anchor="middle" font-weight="bold" fill="#333">Linear Mixed Model (LMM) in Statistical Genetics</text>
  
  <!-- Formula -->
  <rect x="100" y="60" width="600" height="60" fill="#e6f7ff" rx="5" ry="5" stroke="#0099cc" stroke-width="2"/>
  <text x="400" y="100" font-family="Arial" font-size="22" text-anchor="middle" font-weight="bold" fill="#333">y = Xβ + Zu + ε</text>
  
  <!-- Visual representation of the model -->
  <rect x="50" y="140" width="700" height="420" fill="#ffffff" rx="10" ry="10" stroke="#cccccc" stroke-width="2"/>
  
  <!-- Phenotype column (y) -->
  <rect x="100" y="180" width="80" height="300" fill="#ffcccc" rx="5" ry="5" stroke="#ff6666" stroke-width="2"/>
  <text x="140" y="170" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold" fill="#333">Phenotype (y)</text>
  
  <!-- Individual heights as bars in phenotype column -->
  <rect x="110" y="200" width="60" height="20" fill="#ff6666"/>
  <rect x="110" y="230" width="60" height="30" fill="#ff6666"/>
  <rect x="110" y="270" width="60" height="15" fill="#ff6666"/>
  <rect x="110" y="295" width="60" height="40" fill="#ff6666"/>
  <rect x="110" y="345" width="60" height="25" fill="#ff6666"/>
  <rect x="110" y="380" width="60" height="35" fill="#ff6666"/>
  <rect x="110" y="425" width="60" height="22" fill="#ff6666"/>
  <rect x="110" y="457" width="60" height="15" fill="#ff6666"/>
  
  <!-- Fixed effects (Xβ) -->
  <rect x="240" y="180" width="80" height="300" fill="#cce5ff" rx="5" ry="5" stroke="#3399ff" stroke-width="2"/>
  <text x="280" y="170" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold" fill="#333">Fixed Effects (Xβ)</text>
  <text x="280" y="510" font-family="Arial" font-size="14" text-anchor="middle" fill="#333">SNP effects</text>
  
  <!-- SNP effects as bars -->
  <rect x="250" y="200" width="60" height="10" fill="#3399ff"/>
  <rect x="250" y="230" width="60" height="25" fill="#3399ff"/>
  <rect x="250" y="270" width="60" height="5" fill="#3399ff"/>
  <rect x="250" y="295" width="60" height="20" fill="#3399ff"/>
  <rect x="250" y="345" width="60" height="15" fill="#3399ff"/>
  <rect x="250" y="380" width="60" height="25" fill="#3399ff"/>
  <rect x="250" y="425" width="60" height="12" fill="#3399ff"/>
  <rect x="250" y="457" width="60" height="8" fill="#3399ff"/>
  
  <!-- Random effects (Zu) -->
  <rect x="380" y="180" width="80" height="300" fill="#d9f2d9" rx="5" ry="5" stroke="#66cc66" stroke-width="2"/>
  <text x="420" y="170" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold" fill="#333">Random Effects (Zu)</text>
  <text x="420" y="510" font-family="Arial" font-size="14" text-anchor="middle" fill="#333">Relatedness</text>
  
  <!-- Family clusters visually represented -->
  <!-- Family 1 -->
  <rect x="390" y="200" width="60" height="60" fill="#66cc66" opacity="0.7" rx="5" ry="5"/>
  <!-- Family 2 -->
  <rect x="390" y="270" width="60" height="80" fill="#66cc66" opacity="0.7" rx="5" ry="5"/>
  <!-- Family 3 -->
  <rect x="390" y="360" width="60" height="70" fill="#66cc66" opacity="0.7" rx="5" ry="5"/>
  <!-- Family 4 -->
  <rect x="390" y="440" width="60" height="32" fill="#66cc66" opacity="0.7" rx="5" ry="5"/>
  
  <!-- Residual errors (ε) -->
  <rect x="520" y="180" width="80" height="300" fill="#ffe6cc" rx="5" ry="5" stroke="#ff9933" stroke-width="2"/>
  <text x="560" y="170" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold" fill="#333">Residuals (ε)</text>
  <text x="560" y="510" font-family="Arial" font-size="14" text-anchor="middle" fill="#333">Unexplained variance</text>
  
  <!-- Random noise pattern for residuals -->
  <path d="M530,210 q10,15 20,0 q10,-15 20,0 q10,15 20,0" stroke="#ff9933" stroke-width="2" fill="none"/>
  <path d="M530,240 q10,-10 20,0 q10,10 20,0 q10,-10 20,0" stroke="#ff9933" stroke-width="2" fill="none"/>
  <path d="M530,270 q5,12 10,0 q5,-12 10,0 q5,12 10,0 q5,-12 10,0 q5,12 10,0" stroke="#ff9933" stroke-width="2" fill="none"/>
  <path d="M530,300 q15,8 30,0 q15,-8 30,0" stroke="#ff9933" stroke-width="2" fill="none"/>
  <path d="M530,330 q5,-10 10,0 q5,10 10,0 q5,-10 10,0 q5,10 10,0 q5,-10 10,0" stroke="#ff9933" stroke-width="2" fill="none"/>
  <path d="M530,360 q10,12 20,0 q10,-12 20,0 q10,12 20,0" stroke="#ff9933" stroke-width="2" fill="none"/>
  <path d="M530,390 q7,-9 14,0 q7,9 14,0 q7,-9 14,0 q7,9 14,0" stroke="#ff9933" stroke-width="2" fill="none"/>
  <path d="M530,420 q12,10 24,0 q12,-10 24,0" stroke="#ff9933" stroke-width="2" fill="none"/>
  <path d="M530,450 q8,-7 16,0 q8,7 16,0 q8,-7 16,0" stroke="#ff9933" stroke-width="2" fill="none"/>
  
  <!-- People representing observations with family connections -->
  <g transform="translate(650, 230)">
    <!-- Family tree -->
    <text x="0" y="-20" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold" fill="#333">Sample Population</text>
    
    <!-- Person 1 -->
    <circle cx="-30" cy="0" r="15" fill="#ffcc99" stroke="#333" stroke-width="1"/>
    <circle cx="-33" cy="-5" r="3" fill="#333"/> <!-- left eye -->
    <circle cx="-27" cy="-5" r="3" fill="#333"/> <!-- right eye -->
    <path d="M-35,5 Q-30,10 -25,5" stroke="#333" stroke-width="1" fill="none"/> <!-- smile -->
    
    <!-- Person 2 (related to 1) -->
    <circle cx="30" cy="0" r="15" fill="#ffcc99" stroke="#333" stroke-width="1"/>
    <circle cx="27" cy="-5" r="3" fill="#333"/> <!-- left eye -->
    <circle cx="33" cy="-5" r="3" fill="#333"/> <!-- right eye -->
    <path d="M25,5 Q30,10 35,5" stroke="#333" stroke-width="1" fill="none"/> <!-- smile -->
    
    <!-- Connection between related people -->
    <line x1="-15" y1="0" x2="15" y2="0" stroke="#66cc66" stroke-width="3"/>
    
    <!-- Person 3 (unrelated) -->
    <circle cx="0" cy="50" r="15" fill="#ffcc99" stroke="#333" stroke-width="1"/>
    <circle cx="-3" cy="45" r="3" fill="#333"/> <!-- left eye -->
    <circle cx="3" cy="45" r="3" fill="#333"/> <!-- right eye -->
    <path d="M-5,55 Q0,60 5,55" stroke="#333" stroke-width="1" fill="none"/> <!-- smile -->
    
    <text x="0" y="80" font-family="Arial" font-size="12" text-anchor="middle" fill="#333">Individuals with</text>
    <text x="0" y="95" font-family="Arial" font-size="12" text-anchor="middle" fill="#333">varying relatedness</text>
  </g>
  
  <!-- Kinship matrix representation -->
  <g transform="translate(650, 380)">
    <text x="0" y="-15" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold" fill="#333">Kinship Matrix (Z)</text>
    
    <rect x="-40" y="0" width="80" height="80" fill="#e6f7ff" stroke="#3399ff" stroke-width="1"/>
    
    <!-- Matrix diagonal (self-relatedness = 1) -->
    <rect x="-40" y="0" width="20" height="20" fill="#3399ff" opacity="0.9"/>
    <rect x="-20" y="20" width="20" height="20" fill="#3399ff" opacity="0.9"/>
    <rect x="0" y="40" width="20" height="20" fill="#3399ff" opacity="0.9"/>
    <rect x="20" y="60" width="20" height="20" fill="#3399ff" opacity="0.9"/>
    
    <!-- Family 1 relatedness -->
    <rect x="-40" y="20" width="20" height="20" fill="#3399ff" opacity="0.5"/>
    <rect x="-20" y="0" width="20" height="20" fill="#3399ff" opacity="0.5"/>
    
    <!-- Family 2 relatedness -->
    <rect x="0" y="60" width="20" height="20" fill="#3399ff" opacity="0.5"/>
    <rect x="20" y="40" width="20" height="20" fill="#3399ff" opacity="0.5"/>
    
    <text x="0" y="95" font-family="Arial" font-size="12" text-anchor="middle" fill="#333">Captures genetic</text>
    <text x="0" y="110" font-family="Arial" font-size="12" text-anchor="middle" fill="#333">relatedness</text>
  </g>
  
  <!-- Arrows showing the equation components -->
  <line x1="140" y1="530" x2="140" y2="550" stroke="#333" stroke-width="2"/>
  <line x1="280" y1="530" x2="280" y2="550" stroke="#333" stroke-width="2"/>
  <line x1="420" y1="530" x2="420" y2="550" stroke="#333" stroke-width="2"/>
  <line x1="560" y1="530" x2="560" y2="550" stroke="#333" stroke-width="2"/>
  
  <line x1="140" y1="550" x2="560" y2="550" stroke="#333" stroke-width="2"/>
  
  <text x="350" y="570" font-family="Arial" font-size="18" text-anchor="middle" fill="#333">y = Xβ + Zu + ε</text>
</svg>