<svg viewBox="0 0 800 800" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="800" height="800" fill="#f8f9fa" />
  
  <!-- Title -->
  <text x="400" y="40" font-family="Arial" font-size="24" text-anchor="middle" font-weight="bold">Genetic Regression Models &amp; GWAS</text>
  
  <!-- Single Variant Regression Panel -->
  <rect x="50" y="70" width="340" height="260" fill="white" stroke="#ddd" rx="10" ry="10" />
  <text x="220" y="95" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold">Single Variant Regression</text>
  <text x="220" y="120" font-family="Arial" font-size="14" text-anchor="middle" font-style="italic">y = X<tspan baseline-shift="sub" font-size="10">j</tspan>β + ε</text>
  
  <!-- Single variant visualization -->
  <g transform="translate(90, 140)">
    <!-- Trait vector -->
    <rect x="0" y="0" width="30" height="120" fill="#FFD700" stroke="#333" stroke-width="2" />
    <text x="15" y="-10" font-family="Arial" font-size="14" text-anchor="middle">y</text>
    <text x="15" y="140" font-family="Arial" font-size="10" text-anchor="middle">N × 1</text>
    <text x="15" y="155" font-family="Arial" font-size="10" text-anchor="middle">Trait</text>
    
    <!-- Equals symbol -->
    <text x="45" y="60" font-family="Arial" font-size="18" text-anchor="middle">=</text>
    
    <!-- SNP vector -->
    <rect x="60" y="0" width="30" height="120" fill="#99CCFF" stroke="#3366CC" stroke-width="2" />
    <text x="75" y="-10" font-family="Arial" font-size="14" text-anchor="middle">X<tspan baseline-shift="sub" font-size="10">j</tspan></text>
    <text x="75" y="140" font-family="Arial" font-size="10" text-anchor="middle">N × 1</text>
    <text x="75" y="155" font-family="Arial" font-size="10" text-anchor="middle">Genotype</text>
    
    <!-- Beta (coefficient) -->
    <rect x="105" y="50" width="30" height="30" fill="#FF9999" stroke="#CC3333" stroke-width="2" />
    <text x="120" y="-10" font-family="Arial" font-size="14" text-anchor="middle">β</text>
    <text x="120" y="65" font-family="Arial" font-size="14" text-anchor="middle">β</text>
    <text x="120" y="140" font-family="Arial" font-size="10" text-anchor="middle">Effect</text>
    
    <!-- Plus symbol -->
    <text x="150" y="60" font-family="Arial" font-size="18" text-anchor="middle">+</text>
    
    <!-- Error vector -->
    <rect x="170" y="0" width="30" height="120" fill="#CCCCCC" stroke="#666666" stroke-width="2" />
    <text x="185" y="-10" font-family="Arial" font-size="14" text-anchor="middle">ε</text>
    <text x="185" y="140" font-family="Arial" font-size="10" text-anchor="middle">N × 1</text>
    <text x="185" y="155" font-family="Arial" font-size="10" text-anchor="middle">Error</text>
    
    <!-- Individual example -->
    <rect x="220" y="30" width="120" height="80" fill="#E6F3FF" stroke="#3366CC" stroke-width="1" rx="5" ry="5" />
    <text x="280" y="50" font-family="Arial" font-size="12" text-anchor="middle">For individual i:</text>
    <text x="280" y="70" font-family="Arial" font-size="12" text-anchor="middle" font-style="italic">y<tspan baseline-shift="sub" font-size="8">i</tspan> = βX<tspan baseline-shift="sub" font-size="8">i,j</tspan> + ε<tspan baseline-shift="sub" font-size="8">i</tspan></text>
    <text x="280" y="90" font-family="Arial" font-size="10" text-anchor="middle">Tests one SNP at a time</text>
  </g>
  
  <!-- Multiple Variant Regression Panel -->
  <rect x="410" y="70" width="340" height="260" fill="white" stroke="#ddd" rx="10" ry="10" />
  <text x="580" y="95" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold">Multiple Variant Regression</text>
  <text x="580" y="120" font-family="Arial" font-size="14" text-anchor="middle" font-style="italic">Y = Xβ + ε</text>
  
  <!-- Multiple variant visualization -->
  <g transform="translate(450, 140)">
    <!-- Trait vector -->
    <rect x="0" y="0" width="30" height="120" fill="#FFD700" stroke="#333" stroke-width="2" />
    <text x="15" y="-10" font-family="Arial" font-size="14" text-anchor="middle">Y</text>
    <text x="15" y="140" font-family="Arial" font-size="10" text-anchor="middle">N × 1</text>
    <text x="15" y="155" font-family="Arial" font-size="10" text-anchor="middle">Trait</text>
    
    <!-- Equals symbol -->
    <text x="45" y="60" font-family="Arial" font-size="18" text-anchor="middle">=</text>
    
    <!-- SNP matrix -->
    <rect x="60" y="0" width="80" height="120" fill="#99CCFF" stroke="#3366CC" stroke-width="2" />
    <text x="100" y="-10" font-family="Arial" font-size="14" text-anchor="middle">X</text>
    <text x="100" y="140" font-family="Arial" font-size="10" text-anchor="middle">N × M</text>
    <text x="100" y="155" font-family="Arial" font-size="10" text-anchor="middle">Multiple variants</text>
    
    <!-- Beta vector (coefficients) -->
    <rect x="155" y="30" width="30" height="60" fill="#FF9999" stroke="#CC3333" stroke-width="2" />
    <text x="170" y="-10" font-family="Arial" font-size="14" text-anchor="middle">β</text>
    <text x="170" y="140" font-family="Arial" font-size="10" text-anchor="middle">M × 1</text>
    <text x="170" y="155" font-family="Arial" font-size="10" text-anchor="middle">Effects</text>
    
    <!-- Plus symbol -->
    <text x="200" y="60" font-family="Arial" font-size="18" text-anchor="middle">+</text>
    
    <!-- Error vector -->
    <rect x="220" y="0" width="30" height="120" fill="#CCCCCC" stroke="#666666" stroke-width="2" />
    <text x="235" y="-10" font-family="Arial" font-size="14" text-anchor="middle">ε</text>
    <text x="235" y="140" font-family="Arial" font-size="10" text-anchor="middle">N × 1</text>
    <text x="235" y="155" font-family="Arial" font-size="10" text-anchor="middle">Error</text>
  </g>
  
  <!-- OLS Estimation Panel -->
  <rect x="50" y="350" width="340" height="210" fill="white" stroke="#ddd" rx="10" ry="10" />
  <text x="220" y="375" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold">Ordinary Least Squares (OLS)</text>
  <text x="220" y="395" font-family="Arial" font-size="14" text-anchor="middle" font-style="italic">β̂<tspan baseline-shift="sub" font-size="10">OLS</tspan> = (X<tspan baseline-shift="super" font-size="10">T</tspan>X)<tspan baseline-shift="super" font-size="10">-1</tspan>X<tspan baseline-shift="super" font-size="10">T</tspan>Y</text>
  
  <!-- OLS visualization -->
  <g transform="translate(75, 420)">
    <!-- Beta hat -->
    <rect x="0" y="20" width="30" height="60" fill="#FF9999" stroke="#CC3333" stroke-width="2" />
    <text x="15" y="5" font-family="Arial" font-size="14" text-anchor="middle">β̂</text>
    
    <!-- Equals symbol -->
    <text x="45" y="50" font-family="Arial" font-size="18" text-anchor="middle">=</text>
    
    <!-- (X'X)^-1 -->
    <rect x="60" y="20" width="60" height="60" fill="#E6F3FF" stroke="#3366CC" stroke-width="2" />
    <text x="90" y="5" font-family="Arial" font-size="14" text-anchor="middle">(X<tspan baseline-shift="super" font-size="10">T</tspan>X)<tspan baseline-shift="super" font-size="10">-1</tspan></text>
    
    <!-- Multiply symbol -->
    <text x="135" y="50" font-family="Arial" font-size="18" text-anchor="middle">×</text>
    
    <!-- X' -->
    <rect x="150" y="30" width="60" height="40" fill="#99CCFF" stroke="#3366CC" stroke-width="2" />
    <text x="180" y="5" font-family="Arial" font-size="14" text-anchor="middle">X<tspan baseline-shift="super" font-size="10">T</tspan></text>
    
    <!-- Multiply symbol -->
    <text x="225" y="50" font-family="Arial" font-size="18" text-anchor="middle">×</text>
    
    <!-- Y vector -->
    <rect x="240" y="20" width="30" height="60" fill="#FFD700" stroke="#333" stroke-width="2" />
    <text x="255" y="5" font-family="Arial" font-size="14" text-anchor="middle">Y</text>
    
    <!-- Problem note -->
    <rect x="70" y="100" width="200" height="60" fill="#FFEEEE" stroke="#CC3333" stroke-width="1" rx="5" ry="5" />
    <text x="170" y="120" font-family="Arial" font-size="12" text-anchor="middle">Problem when M >> N:</text>
    <text x="170" y="140" font-family="Arial" font-size="12" text-anchor="middle">(X<tspan baseline-shift="super" font-size="10">T</tspan>X) becomes singular</text>
    <text x="170" y="160" font-family="Arial" font-size="12" text-anchor="middle">Cannot be inverted!</text>
  </g>
  
  <!-- GWAS Panel -->
  <rect x="410" y="350" width="340" height="210" fill="white" stroke="#ddd" rx="10" ry="10" />
  <text x="580" y="375" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold">GWAS Approach</text>
  <text x="580" y="395" font-family="Arial" font-size="14" text-anchor="middle">Test each SNP independently</text>
  
  <!-- GWAS visualization -->
  <g transform="translate(430, 425)">
    <!-- SNP matrix visualization -->
    <rect x="0" y="0" width="120" height="80" fill="#99CCFF" stroke="#3366CC" stroke-width="2" />
    <text x="60" y="-10" font-family="Arial" font-size="14" text-anchor="middle">Millions of SNPs</text>
    <text x="60" y="40" font-family="Arial" font-size="16" text-anchor="middle">X</text>
    <text x="60" y="95" font-family="Arial" font-size="12" text-anchor="middle">N × M where M >> N</text>
    
    <!-- Arrow -->
    <path d="M130,40 L160,40 L160,10 L180,40 L160,70 L160,40" fill="#333" />
    
    <!-- Single SNP testing -->
    <g transform="translate(180, 0)">
      <rect x="0" y="0" width="20" height="80" fill="#99CCFF" stroke="#3366CC" stroke-width="2" />
      <rect x="30" y="0" width="20" height="80" fill="#99CCFF" stroke="#3366CC" stroke-width="2" />
      <rect x="60" y="0" width="20" height="80" fill="#99CCFF" stroke="#3366CC" stroke-width="2" />
      <rect x="90" y="0" width="20" height="80" fill="#99CCFF" stroke="#3366CC" stroke-width="2" />
      <text x="10" y="95" font-family="Arial" font-size="12" text-anchor="middle">SNP 1</text>
      <text x="40" y="95" font-family="Arial" font-size="12" text-anchor="middle">SNP 2</text>
      <text x="70" y="95" font-family="Arial" font-size="12" text-anchor="middle">SNP 3</text>
      <text x="100" y="95" font-family="Arial" font-size="12" text-anchor="middle">SNP 4</text>
      <text x="55" y="-10" font-family="Arial" font-size="14" text-anchor="middle">Test one at a time</text>
    </g>
  </g>
  
  <!-- Bottom Panel: GWAS Rationale -->
  <rect x="50" y="580" width="700" height="200" fill="white" stroke="#ddd" rx="10" ry="10" />
  <text x="400" y="605" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold">Why Single Variant Testing in GWAS?</text>
  
  <!-- GWAS Manhattan plot sketch -->
  <g transform="translate(100, 620)">
    <!-- X-axis -->
    <line x1="0" y1="90" x2="300" y2="90" stroke="#333" stroke-width="2" />
    <text x="150" y="110" font-family="Arial" font-size="12" text-anchor="middle">Chromosome Position</text>
    
    <!-- Y-axis -->
    <line x1="0" y1="90" x2="0" y2="0" stroke="#333" stroke-width="2" />
    <text x="-20" y="45" font-family="Arial" font-size="12" text-anchor="middle" transform="rotate(-90, -20, 45)">-log10(p-value)</text>
    
    <!-- Significance threshold -->
    <line x1="0" y1="30" x2="300" y2="30" stroke="#CC3333" stroke-width="1" stroke-dasharray="5,3" />
    <text x="310" y="30" font-family="Arial" font-size="10" text-anchor="start">Significance</text>
    
    <!-- Manhattan plot dots -->
    <g fill="#3366CC" opacity="0.5">
      <circle cx="10" cy="80" r="2" />
      <circle cx="15" cy="75" r="2" />
      <circle cx="20" cy="82" r="2" />
      <circle cx="25" cy="70" r="2" />
      <circle cx="30" cy="75" r="2" />
      <circle cx="35" cy="78" r="2" />
      <circle cx="40" cy="60" r="2" />
      <circle cx="45" cy="65" r="2" />
      <circle cx="50" cy="75" r="2" />
      <circle cx="55" cy="85" r="2" />
      <circle cx="60" cy="75" r="2" />
      <circle cx="65" cy="70" r="2" />
      <circle cx="70" cy="55" r="2" />
      <circle cx="75" cy="85" r="2" />
      <circle cx="80" cy="80" r="2" />
      <circle cx="85" cy="65" r="2" />
      <circle cx="90" cy="75" r="2" />
      <circle cx="100" cy="20" r="3" fill="#CC3333" />
      <circle cx="105" cy="25" r="2" />
      <circle cx="110" cy="80" r="2" />
      <circle cx="120" cy="75" r="2" />
      <circle cx="125" cy="60" r="2" />
      <circle cx="130" cy="85" r="2" />
      <circle cx="140" cy="80" r="2" />
      <circle cx="150" cy="75" r="2" />
      <circle cx="160" cy="60" r="2" />
      <circle cx="170" cy="85" r="2" />
      <circle cx="180" cy="80" r="2" />
      <circle cx="190" cy="75" r="2" />
      <circle cx="200" cy="15" r="3" fill="#CC3333" />
      <circle cx="210" cy="85" r="2" />
      <circle cx="220" cy="80" r="2" />
      <circle cx="230" cy="75" r="2" />
      <circle cx="240" cy="60" r="2" />
      <circle cx="250" cy="85" r="2" />
      <circle cx="260" cy="80" r="2" />
      <circle cx="270" cy="75" r="2" />
      <circle cx="280" cy="60" r="2" />
      <circle cx="290" cy="85" r="2" />
    </g>
    
    <!-- Benefits text -->
    <g transform="translate(350, 10)">
      <text x="0" y="0" font-family="Arial" font-size="14" font-weight="bold">Benefits of Single Variant Testing:</text>
      <text x="0" y="25" font-family="Arial" font-size="12">1. Statistical simplicity</text>
      <text x="0" y="45" font-family="Arial" font-size="12">2. Avoids overfitting (too many parameters)</text>
      <text x="0" y="65" font-family="Arial" font-size="12">3. Enables multiple testing correction</text>
      <text x="0" y="85" font-family="Arial" font-size="12">4. Easier interpretation</text>
      <text x="0" y="105" font-family="Arial" font-size="12">5. Computationally feasible</text>
      <text x="0" y="125" font-family="Arial" font-size="12">6. Identifies individual SNP effects</text>
    </g>
  </g>
</svg>